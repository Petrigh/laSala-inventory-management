import{a as Se}from"./chunk-5CZITQUW.js";import{a as ge,b as be,c as ye}from"./chunk-644H75FQ.js";import{A as Fe,B as xe,C as we,D as Me,a as me,b as de,d as pe,n as ue,o as fe,s as he,w as Ce,x as _e,y as ze,z as ve}from"./chunk-LR7HS7ST.js";import{Ka as $,La as ee,Ma as te,Na as ie,Oa as ne,U as Y,V as Z,Va as oe,Wa as re,Xa as ae,Ya as le,c as S,d as G,f as O,g as L,h as H,i as q,k as J,n as K,p as Q,r as P,s as X}from"./chunk-RDDHBD4O.js";import"./chunk-WYLD3DAA.js";import{b as B,m as se,n as ce}from"./chunk-JBFZACTD.js";import{$b as N,Ca as u,Cc as U,Da as f,Db as a,Dc as W,Eb as r,Fb as g,Ib as M,Kc as j,Lb as b,Nb as C,Ub as V,Vb as m,Xb as A,Zb as T,_b as I,bc as y,cc as R,d as z,db as s,eb as h,ga as k,la as E,nb as D,ra as w,tb as F,v,vb as c}from"./chunk-FXUVGPCX.js";var x=class{constructor(i){this.id=i?.id,this.nombre=i?.nombre}};var Pe=(()=>{let i=class i{constructor(e){this.fb=e,this.familia=new x(null),this.edit=!1,this.validateForm=this.fb.group({id:[null],nombre:[null,G.required]})}patchFormValues(e){e&&(this.familia=e,this.edit=!0,this.validateForm.patchValue(this.familia))}submitForm(){return new x(this.validateForm.getRawValue())}};i.\u0275fac=function(t){return new(t||i)(h(Q))},i.\u0275cmp=w({type:i,selectors:[["app-form-familia"]],standalone:!0,features:[y],decls:7,vars:1,consts:[["nz-form","",3,"ngSubmit","formGroup"],[1,"form-item"],["nzFor","nombre","nzRequired","",1,"form-label"],["nzErrorTip","Ingrese un nombre",1,"form-control"],["nz-input","","formControlName","nombre","id","nombre"]],template:function(t,n){t&1&&(a(0,"form",0),b("ngSubmit",function(){return n.submitForm()}),a(1,"nz-form-item",1)(2,"div")(3,"nz-form-label",2),m(4,"Nombre"),r(),a(5,"nz-form-control",3),g(6,"input",4),r()()()()),t&2&&c("formGroup",n.validateForm)},dependencies:[P,q,S,O,L,X,J,K,ne,Z,Y,ee,$,ie,te],styles:[".form-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.row[_ngcontent-%COMP%]{display:grid;grid-template:100px / auto auto;row-gap:15px}.rolSelect[_ngcontent-%COMP%]{min-width:180px}"]});let o=i;return o})();var Ve=(()=>{let i=class i{constructor(e){this.http=e,this.apiUrl=se.apiUrl+"/familiaProductora"}getFamilias(){return this.http.get(this.apiUrl)}getFamiliaById(e){return this.http.get(this.apiUrl+"/"+e)}updateFamilias(e,t){return t?this.http.put(this.apiUrl+"/"+e.id,e):this.http.post(this.apiUrl,e)}deleteFamilia(e){return this.http.delete(this.apiUrl+"/"+e)}};i.\u0275fac=function(t){return new(t||i)(E(B))},i.\u0275prov=k({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var ke=()=>({y:"450px"});function Ee(o,i){if(o&1){let d=M();a(0,"button",17),b("click",function(){u(d);let t=C();return f(t.showModal(void 0))}),g(1,"fa-icon",18),m(2," A\xF1adir Familia "),r()}if(o&2){let d=C();s(),c("icon",d.addIcon)}}function De(o,i){o&1&&(a(0,"th",19),m(1,"EDITAR"),r())}function Ae(o,i){if(o&1){let d=M();a(0,"td",21),b("click",function(){u(d);let t=C().$implicit,n=C();return f(n.showModal(t))}),g(1,"fa-icon",22),r()}if(o&2){let d=C(2);s(),c("icon",d.editIcon)}}function Re(o,i){if(o&1&&(a(0,"tr")(1,"td"),m(2),r(),F(3,Ae,2,1,"td",20),r()),o&2){let d=i.$implicit,e=C();s(2),A(" ",d.nombre," "),s(),c("ngIf",e.isAdmin)}}var Te=(()=>{let i=class i{constructor(e,t,n,l){this.userService=e,this.familiaService=t,this.modal=n,this.viewContainerRef=l,this.addIcon=fe,this.buscarIcon=ue,this.editIcon=pe,this.familias=[],this.datosTabla=[],this.isAdmin=!1,this.searchValue="",this.visible=!1}ngOnInit(){this.userService.isAdmin$.subscribe(e=>{this.isAdmin=e}),this.familiaService.getFamilias().subscribe(e=>{this.familias=e,this.datosTabla=e})}reset(){this.searchValue="",this.search()}search(){this.visible=!1,this.datosTabla=this.familias.filter(e=>e.nombre.toLocaleUpperCase().indexOf(this.searchValue.toLocaleUpperCase())!==-1)}onDelete(e,t){return z(this,null,function*(){yield v(this.familiaService.deleteFamilia(e)),t.close(),this.familias=yield v(this.familiaService.getFamilias()),this.datosTabla=this.familias})}onSubmit(e,t,n){return z(this,null,function*(){try{if(t.validateForm.valid)yield v(this.familiaService.updateFamilias(t.submitForm(),e)),n.close(),this.familias=yield v(this.familiaService.getFamilias()),this.datosTabla=this.familias;else for(let l in t.validateForm.controls)t.validateForm.controls.hasOwnProperty(l)&&(t.validateForm.controls[l].markAsDirty(),t.validateForm.controls[l].updateValueAndValidity())}catch(l){console.error("Error updating familias",l)}})}showModal(e){let t=[{label:"Cancelar",type:"text",danger:!1,onClick:()=>n.destroy()},{label:e?"Editar":"Cargar",type:"primary",danger:!1,onClick:()=>z(this,null,function*(){this.modal.confirm({nzCentered:!0,nzTitle:"Confirmar "+(e?"edicion?":"guardado?"),nzOnOk:()=>this.onSubmit(!!e,n.getContentComponent(),n),nzOkText:e?"Editar":"Guardar",nzCancelText:"Cancelar"})})}];e&&t.push({label:"Eliminar",type:"primary",danger:!0,onClick:()=>z(this,null,function*(){this.modal.warning({nzCentered:!0,nzTitle:"Eliminar Familia Productora?",nzOnOk:()=>this.onDelete(e.id,n),nzOkText:"Eliminar",nzCancelText:"Cancelar"})})});let n=this.modal.create({nzTitle:e?"Editar Familia Productora":"Cargar Familia Productora",nzContent:Pe,nzViewContainerRef:this.viewContainerRef,nzCentered:!0,nzWidth:350,nzFooter:t});e&&n.componentInstance.patchFormValues(e)}};i.\u0275fac=function(t){return new(t||i)(h(ce),h(Ve),h(ge),h(D))},i.\u0275cmp=w({type:i,selectors:[["app-familias"]],standalone:!0,features:[y],decls:26,vars:12,consts:[["tablaFamilias",""],["menu","nzDropdownMenu"],[1,"header-container"],[1,"title"],[1,"spacer"],["class","buttonAdd","nz-button","",3,"click",4,"ngIf"],[3,"nzData","nzPageSize","nzScroll"],["nzWidth","100px"],[3,"nzVisibleChange","nzVisible","nzActive","nzDropdownMenu"],[1,"buscarIcon",3,"icon"],["nzWidth","50px",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"ant-table-filter-dropdown"],[1,"search-box"],["type","text","nz-input","","placeholder","Search name",3,"ngModelChange","ngModel"],["nz-button","","nzSize","small",1,"search-button",3,"click"],["nz-button","","nzSize","small",3,"click"],["nz-button","",1,"buttonAdd",3,"click"],[3,"icon"],["nzWidth","50px"],["class","tableHover",3,"click",4,"ngIf"],[1,"tableHover",3,"click"],[1,"tableIcon",3,"icon"]],template:function(t,n){if(t&1){let l=M();a(0,"body")(1,"div",2)(2,"h1",3),m(3,"Familias Productoras"),r(),g(4,"div",4),F(5,Ee,3,1,"button",5),r(),a(6,"nz-table",6,0)(8,"thead")(9,"tr")(10,"th",7),m(11,"NOMBRE "),a(12,"nz-filter-trigger",8),N("nzVisibleChange",function(p){return u(l),I(n.visible,p)||(n.visible=p),f(p)}),g(13,"fa-icon",9),r()(),F(14,De,2,0,"th",10),r()(),a(15,"tbody"),F(16,Re,4,2,"tr",11),r()(),a(17,"nz-dropdown-menu",null,1)(19,"div",12)(20,"div",13)(21,"input",14),N("ngModelChange",function(p){return u(l),I(n.searchValue,p)||(n.searchValue=p),f(p)}),r(),a(22,"button",15),b("click",function(){return u(l),f(n.search())}),m(23,"Buscar"),r(),a(24,"button",16),b("click",function(){return u(l),f(n.reset())}),m(25,"Limpiar"),r()()()()()}if(t&2){let l=V(7),_=V(18);s(5),c("ngIf",n.isAdmin),s(),c("nzData",n.datosTabla)("nzPageSize",7)("nzScroll",R(11,ke)),s(6),T("nzVisible",n.visible),c("nzActive",n.searchValue.length>0)("nzDropdownMenu",_),s(),c("icon",n.buscarIcon),s(),c("ngIf",n.isAdmin),s(2),c("ngForOf",l.data),s(5),T("ngModel",n.searchValue)}},dependencies:[W,U,j,P,S,O,H,Me,Fe,_e,ze,we,ve,xe,Ce,be,he,le,ae,oe,re,de,me],styles:["body[_ngcontent-%COMP%]{background-color:#bdd2c4;display:flex;justify-content:center;flex-direction:column;align-items:center;margin:0;padding:160px}tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#395144;color:#f0ebce;white-space:nowrap;text-align:center}.buscarIcon[_ngcontent-%COMP%]{color:#8a6a44;font-size:16px}.buscarIcon[_ngcontent-%COMP%]:hover{color:orange}tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;border-right:1px solid #f1ecec}tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-right:none}.header-container[_ngcontent-%COMP%]{padding-right:20px;width:100%;display:flex;align-items:center;margin-bottom:20px}.title[_ngcontent-%COMP%]{margin:0;color:#395144;font-size:30px;font-weight:700}.spacer[_ngcontent-%COMP%]{flex-grow:1}.buttonAdd[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:7px;margin-left:auto;background-color:#8a6a44!important;border-color:#8a6a44!important;color:#f0ebce!important}.tableHover[_ngcontent-%COMP%]{text-align:center;vertical-align:middle}.tableHover[_ngcontent-%COMP%]:hover{cursor:pointer}.tableHover[_ngcontent-%COMP%]:hover > .tableIcon[_ngcontent-%COMP%]{color:orange}.tableIcon[_ngcontent-%COMP%]{color:#8a6a44;font-weight:700;font-size:18px}.search-box[_ngcontent-%COMP%]{padding:8px}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:188px;margin-bottom:8px;display:block}.search-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:90px}.search-button[_ngcontent-%COMP%]{margin-right:8px;background-color:#8a6a44;border-color:#8a6a44;color:#f0ebce}"]});let o=i;return o})();var gt=[{path:"",component:Te,canActivate:[ye,Se]}];export{gt as FAMILIAS_ROUTES};
